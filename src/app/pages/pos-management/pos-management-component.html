<div class="card shadow-sm p-4 rounded-xl bg-white">
  <div class="flex justify-between items-center mb-4">
    <h2 class="text-xl font-semibold text-gray-700">ุฅุฏุงุฑุฉ ุงูุตูุงุฏูู</h2>

    <div class="flex gap-2">
      <input
        type="text"
        pInputText
        placeholder="ุงุจุญุซ ุจุงุณู ุงูุตูุฏูู ุฃู ุงููููุน"
        [(ngModel)]="searchTerm"
        (input)="filterBoxes()"
        class="w-64"
      />
      <button
        pButton
        label="ุฅุถุงูุฉ ุตูุฏูู ุฌุฏูุฏ"
        icon="pi pi-plus"
        class="p-button-success"
        (click)="openAddDialog()"
      ></button>
    </div>
  </div>

  <p-table
    #dt
    [value]="filteredBoxes"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[10, 20, 50]"
    [responsiveLayout]="'scroll'"
    dataKey="id"
    [showGridlines]="true"
    class="p-datatable-sm rounded-md"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>ุงููููุน</th>
        <th>ุงุณู ุงูุตูุฏูู</th>
        <th>ูุชุญ ุจูุงุณุทุฉ</th>
        <th>ุชุงุฑูุฎ ุงููุชุญ</th>
        <th>ุชุงุฑูุฎ ุงูุฅุบูุงู</th>
        <th>ุงูุญุงูุฉ</th>
        <th class="text-center">ุงูุฅุฌุฑุงุกุงุช</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-box>
      <tr>
        <td>{{ box.location }}</td>
        <td>{{ box.name }}</td>
        <td>{{ box.openedBy }}</td>
        <td>{{ box.openDate | date: 'yyyy-MM-dd' }}</td>
        <td>{{ box.closeDate ? (box.closeDate | date: 'yyyy-MM-dd') : '-' }}</td>
        <td>
          <span
            class="px-2 py-1 rounded-lg text-white text-sm"
            [ngClass]="{
              'bg-green-500': box.status === 'ููุชูุญ',
              'bg-blue-500': box.status === 'ูุชูุงุฒู',
              'bg-red-500': box.status === 'ูุบูู'
            }"
          >
            {{ box.status }}
          </span>
        </td>
        <td class="text-center">
          <button
            pButton
            icon="pi pi-eye"
            class="p-button-rounded p-button-info p-button-sm mr-2"
            tooltip="ุนุฑุถ ุงูุชูุงุตูู"
            (click)="viewBox(box)"
          ></button>

          <button
            pButton
            icon="pi pi-times"
            class="p-button-rounded p-button-danger p-button-sm"
            tooltip="ุฅุบูุงู ุงูุตูุฏูู"
            (click)="closeBox(box)"
            [disabled]="box.status !== 'ููุชูุญ'"
          ></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<!-- ๐งพ ูุงูุฐุฉ ุฅุถุงูุฉ ุตูุฏูู ุฌุฏูุฏ -->
<p-dialog
  header="ุฅุถุงูุฉ ุตูุฏูู ุจูุน ุฌุฏูุฏ"
  [(visible)]="addDialogVisible"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '450px' }"
>
  <div class="p-fluid space-y-4">
    <div class="field">
      <label class="font-semibold mb-2 block">ุงุณู ุงูุตูุฏูู</label>
      <input
        type="text"
        pInputText
        placeholder="ุฃุฏุฎู ุงุณู ุงูุตูุฏูู"
        [(ngModel)]="newBox.name"
        class="w-full"
      />
    </div>

    <div class="field">
      <label class="font-semibold mb-2 block">ุงููููุน</label>
      <input
        type="text"
        pInputText
        placeholder="ูุซูุงู: ูุฑุน ุฌุฏุฉ"
        [(ngModel)]="newBox.location"
        class="w-full"
      />
    </div>

    <div class="flex justify-end gap-2 pt-4 border-t">
      <button
        pButton
        label="ุฅูุบุงุก"
        icon="pi pi-times"
        class="p-button-text text-gray-600 hover:text-red-500"
        (click)="addDialogVisible = false"
      ></button>
      <button
        pButton
        label="ุญูุธ"
        icon="pi pi-check"
        class="p-button-success"
        (click)="saveNewBox()"
      ></button>
    </div>
  </div>
</p-dialog>
